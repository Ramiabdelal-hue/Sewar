# ููุฎุต ุชุญุฏูุซุงุช ูุธุงู ุงูุฏูุน

## โ ุงูุชุญุฏูุซุงุช ุงููููุฐุฉ

### 1. ููุน ุงููุตูู ูุจู ุงูุฏูุน
- โ **ูุจู**: ุงููุณุชุฎุฏู ููููู ุงููุตูู ูููุญุชูู ูุจุงุดุฑุฉ ุจุนุฏ ุงูุชุณุฌูู
- โ **ุงูุขู**: ูุฌุจ ุชุฃููุฏ ุงูุฏูุน ุฃููุงู ูุจู ุงููุตูู ูููุญุชูู

### 2. ูุธุงู QR Code
- โ ุนุฑุถ QR Code ููุฏูุน ุนูุฏ ุงุฎุชูุงุฑ ุทุฑููุฉ "QR Scan"
- โ ุงูุชุญูู ุงูุชููุงุฆู ูู ุญุงูุฉ ุงูุฏูุน ูู 5 ุซูุงูู
- โ ุชูุนูู ุงูุงุดุชุฑุงู ุชููุงุฆูุงู ุนูุฏ ุชุฃููุฏ ุงูุฏูุน
- โ ุฅุนุงุฏุฉ ุชูุฌูู ุงููุณุชุฎุฏู ูููุญุชูู ุจุนุฏ ุงูุฏูุน

### 3. ุชุญุณูู ุชุฌุฑุจุฉ ุงูุฏูุน
- โ ุฑุณุงุฆู ูุงุถุญุฉ ููู ุทุฑููุฉ ุฏูุน
- โ ูุคุดุฑ ุงูุชุธุงุฑ ุฃุซูุงุก ุงูุชุญูู ูู ุงูุฏูุน
- โ ุฅุบูุงู ุชููุงุฆู ููููุงูุฐ ุจุนุฏ ุงูุฏูุน

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

### 1. `components/CheckoutForm.tsx`
**ุงูุชุบููุฑุงุช:**
- ุฅุถุงูุฉ state ููู QR Code (`showQRCode`, `qrCodeData`)
- ุฅุถุงูุฉ state ูุญุงูุฉ ุงูุงูุชุธุงุฑ (`pendingPayment`)
- ุชุนุฏูู ููุทู ุงูุฏูุน ููู ุทุฑููุฉ
- ุฅุถุงูุฉ modal ูุนุฑุถ QR Code
- ุฅุถุงูุฉ ุฏุงูุฉ `redirectToContent` ููุชูุฌูู ุจุนุฏ ุงูุฏูุน
- ุฅุถุงูุฉ ุงูุชุญูู ุงูุชููุงุฆู ูู ุญุงูุฉ ุงูุฏูุน

### 2. `app/api/check-payment-status/route.ts` (ุฌุฏูุฏ)
**ุงููุธููุฉ:**
- ุงูุชุญูู ูู ุญุงูุฉ ุงูุฏูุน ูููุณุชุฎุฏู
- ุฅุฑุฌุงุน `paid: true` ุฅุฐุง ุชู ุงูุฏูุน
- ุฅุฑุฌุงุน `paid: false` ุฅุฐุง ูู ูุชู ุงูุฏูุน ุจุนุฏ

### 3. `app/api/payment-webhook/route.ts` (ููุฌูุฏ ูุณุจูุงู)
**ุงููุธููุฉ:**
- ุงุณุชูุจุงู ุฅุดุนุงุฑุงุช ุงูุฏูุน ูู ุจูุงุจุงุช ุงูุฏูุน
- ุชูุนูู ุงูุงุดุชุฑุงู ุนูุฏ ุชุฃููุฏ ุงูุฏูุน

## ๐ ุณูุฑ ุงูุนูู ุงูุฌุฏูุฏ

### ุณููุงุฑูู 1: Bancontact / PayPal
```
1. ุงููุณุชุฎุฏู ูููุฃ ุงููููุฐุฌ
2. ูุถุบุท "ุฅุฑุณุงู"
3. ุชูุญูุธ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุญุงูุฉ: pending)
4. ุชูุชุญ ูุงูุฐุฉ ุจูุงุจุฉ ุงูุฏูุน
5. ุงููุณุชุฎุฏู ูููู ุงูุฏูุน
6. ุจูุงุจุฉ ุงูุฏูุน ุชุฑุณู webhook
7. ุงูุณูุฑูุฑ ููุนูู ุงูุงุดุชุฑุงู
8. ุงููุณุชุฎุฏู ููุนุงุฏ ุชูุฌููู ูููุญุชูู
```

### ุณููุงุฑูู 2: QR Code
```
1. ุงููุณุชุฎุฏู ูููุฃ ุงููููุฐุฌ
2. ูุถุบุท "ุฅุฑุณุงู"
3. ุชูุญูุธ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุญุงูุฉ: pending)
4. ูุธูุฑ modal ูุน QR Code
5. ุงููุณุชุฎุฏู ููุณุญ ุงูุฑูุฒ
6. ูููู ุงูุฏูุน ูู ุงูุชุทุจูู
7. ุงููุธุงู ูุชุญูู ุชููุงุฆูุงู ูู 5 ุซูุงูู
8. ุนูุฏ ุชุฃููุฏ ุงูุฏูุนุ ูููุนูู ุงูุงุดุชุฑุงู
9. ุงููุณุชุฎุฏู ููุนุงุฏ ุชูุฌููู ูููุญุชูู ุชููุงุฆูุงู
```

## ๐๏ธ ุงูุฎุทูุงุช ุงูุชุงููุฉ ููุชูุนูู

### 1. ุชุซุจูุช ููุชุจุฉ QR Code
```bash
npm install qrcode.react
```

### 2. ุชุญุฏูุซ CheckoutForm ูุงุณุชุฎุฏุงู ุงูููุชุจุฉ
```typescript
import QRCode from "qrcode.react";

// ุงุณุชุจุฏู placeholder QR Code ุจู:
<QRCode
  value={qrCodeData}
  size={256}
  level="H"
  includeMargin={true}
  renderAs="svg"
/>
```

### 3. ุฅุนุฏุงุฏ ุจูุงุจุงุช ุงูุฏูุน
- ุณุฌู ูู Bancontactุ Payconiqุ PayPal
- ุงุญุตู ุนูู API credentials
- ุฃุถู webhook URL: `https://yourdomain.com/api/payment-webhook`
- ุฃุถู credentials ูู `.env`:
```env
BANCONTACT_MERCHANT_ID=xxx
BANCONTACT_API_KEY=xxx
PAYCONIQ_MERCHANT_ID=xxx
PAYPAL_CLIENT_ID=xxx
PAYPAL_CLIENT_SECRET=xxx
```

### 4. ุงุฎุชุจุงุฑ ุงููุธุงู
```bash
# 1. ุชุดุบูู ุงูุณูุฑูุฑ
npm run dev

# 2. ุงุฎุชุจุงุฑ QR Code
# ุงูุชุญ ุงููุชุตูุญ ูุงุฎุชุฑ QR Code ูุทุฑููุฉ ุฏูุน

# 3. ูุญุงูุงุฉ webhook
curl -X POST http://localhost:3000/api/payment-webhook \
  -H "Content-Type: application/json" \
  -d '{
    "paymentMethod": "qr_scan",
    "transactionId": "TEST_123",
    "status": "completed",
    "email": "test@example.com",
    "amount": 25.00
  }'
```

## ๐ ุงูุฃูุงู

### ุญูุงูุฉ ุงููุญุชูู
ูู ุตูุญุฉ ูุญุชูู ูุฌุจ ุฃู ุชุชุญูู ูู:
```typescript
useEffect(() => {
  const checkAccess = async () => {
    const email = localStorage.getItem("userEmail");
    
    if (!email) {
      router.push("/");
      return;
    }

    const res = await fetch("/api/check-subscription", {
      method: "POST",
      body: JSON.stringify({ email }),
    });

    const data = await res.json();
    
    if (!data.success || data.expired) {
      router.push("/");
    }
  };

  checkAccess();
}, []);
```

## ๐ ุงููุซุงุฆู

ุฑุงุฌุน ุงููููุงุช ุงูุชุงููุฉ ูููุฒูุฏ ูู ุงูุชูุงุตูู:
- `PAYMENT-SYSTEM-GUIDE.md` - ุฏููู ุดุงูู ูููุธุงู
- `PAYMENT-WEBHOOK-GUIDE.md` - ุฏููู ุงูู webhooks

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ูุง ุชุญูุธ ุจูุงูุงุช ุงูุงุดุชุฑุงู ูู localStorage ูุจู ุชุฃููุฏ ุงูุฏูุน**
2. **ุงุณุชุฎุฏู HTTPS ูู ุงูุฅูุชุงุฌ**
3. **ุงุญูุธ ุฌููุน API secrets ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ**
4. **ุงุฎุชุจุฑ ุฌููุน ุณููุงุฑูููุงุช ุงูุฏูุน ูุจู ุงููุดุฑ**
5. **ุฑุงูุจ logs ุงูู webhook ุจุงูุชุธุงู**

## ๐ฏ ุงููุชูุฌุฉ

ุงูุขู ุงููุธุงู:
- โ ูููุน ุงููุตูู ูููุญุชูู ูุจู ุงูุฏูุน
- โ ูุฏุนู QR Code ููุฏูุน
- โ ูุชุญูู ุชููุงุฆูุงู ูู ุญุงูุฉ ุงูุฏูุน
- โ ููุนูู ุงูุงุดุชุฑุงู ููุท ุจุนุฏ ุชุฃููุฏ ุงูุฏูุน
- โ ูููุฑ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ
